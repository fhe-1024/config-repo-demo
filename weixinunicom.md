## 河北联通官微添加微秘功能方案
##### http://172.35.21.28:12542
#### 请求方式Post

#### 签名规范
字段名称|字段类型|字段描述|示例数据
---|:--:|---:|---:
key|字符串|接口调用标识，由接口提供方下发，不在请求参数中|mdcunicom
sign|字符串|签名字段，每次接口请求参数中均作为鉴权验证字段|B36DB08CB7E7BF0C6A205221444F374F

- 根据参数名称（除签名和ip） 将所有请求参数按照key升序排序, 然后将请求参数生成一个经过 URL-encode 的请求字符串
例如：将foo=1,bar=2,baz=3 排序为bar=2,baz=3,foo=1，参数名和参数值链接后，得到拼装字符串bar=2&baz=3&foo1=1
- 将密钥key拼接到参数字符串首部和尾部，进行md5加密，然后全部转换为大写字母，格式是：strtoupper(md5(keybar=2&baz=3&foo1=1key))，
key是系统初始化的一个字符串，参与sign的生成，由我方提供。

#### 同步微信用户数据

字段名称|字段类型|字段描述|示例数据
---|:--:|---:|---:
category|字符串|方法名称标识，此接口为syncUser|syncUser
mobile|字符串|手机号码|17602100074
opertype|字符串|操作类型，1绑定2取消绑定|1
opertime|字符串|时间戳|1493468759
sign|字符串|签名信息(见鉴权方式)|B36DB08CB7E7BF0C6A205221444F374F
#### 接口返回html页面

## 鉴权方式

字段名称|字段类型|字段描述|示例数据
---|:--:|---:|---:
token|字符串|接口调用标识，有接口提供方下发|miscall

#### 签名规范：
- 根据参数名称将所有请求参数的值按照字典升序排序
- 字符串拼接成一个字符串进行sha1加密
- 获得加密后的字符串signature，标识该请求来源，接口每次请求时将签名作为参数传递

## 示例
###### 请求参数
``` 
timestamp=1493468759
ownernumber=17602100074
token=miscall
type=1
```
###### 按字典排序后顺序为
``` 
1
1493468759
17602100074
miscall
```
###### 拼接后的字符串为
``` 
1149346875917602100074miscall
```
###### sha1后的字符串为
``` 
543d6bc98f064778f0439d2d14b1e7439eb0188b
```
###### 则漏话查询的url为
``` 
http://hebei.callkr.cn/WeiXinServer/page_bgMissCall.action?timestamp=1493468759&ownernumber=17602100074&type=1&signature=543d6bc98f064778f0439d2d14b1e7439eb0188b
```
