## 河北联通官微添加微秘功能方案

### 1 签名规范
#### 公共字段
字段名称|字段类型|字段描述|示例数据
---|:--:|---:|---:
key|字符串|接口调用标识，由接口提供方下发，不在请求参数中|mdcunicom
sign|字符串|签名字段，每次接口请求参数中均作为鉴权验证字段|B36DB08CB7E7BF0C6A205221444F374F

- 根据参数名称（除签名和ip） 将所有请求参数按照key升序排序, 然后将请求参数生成一个经过 URL-encode 的请求字符串
例如：将foo=1,bar=2,baz=3 排序为bar=2,baz=3,foo=1，参数名和参数值链接后，得到拼装字符串bar=2&baz=3&foo1=1
- 将密钥key拼接到参数字符串首部和尾部，进行md5加密，然后全部转换为大写字母，格式是：strtoupper(md5(keybar=2&baz=3&foo1=1key))，
key是系统初始化的一个字符串，参与sign的生成，由我方提供。

### 2 同步微信用户数据
##### 请求url：http://172.35.21.28:12542
##### 请求方式post
##### 参数以json格式传输
##### 请求字段如下:
字段名称|字段类型|字段描述|示例数据
---|:--:|---:|---:
category|字符串|方法名称标识，此接口为syncUser|syncUser
mobile|字符串|手机号码|17602100074
opertype|字符串|操作类型，1绑定2取消绑定|1
opertime|字符串|时间戳|1493468759
flag|字符串|请求类型标识，固定为weixinunicom|weixinunicom
sign|字符串|签名信息(见鉴权方式)|B36DB08CB7E7BF0C6A205221444F374F
#### 接口返回信息
字段名称|字段类型|字段描述|示例数据
---|:--:|---:|---:
ret|字符串|返回码； 0表示成功，非0表示出错|0
msg|字符串|错误信息|鉴权失败

### 3 设置改号
##### 请求url：http://172.35.21.28:12542
##### 请求方式post
##### 参数以json格式传输
##### 请求字段如下:
字段名称|字段类型|字段描述|示例数据
---|:--:|---:|---:
category|字符串|方法名称标识，此接口为changeTel|changeTel
ownernumber|字符串|原手机号码|17602100074
othernumber|字符串|新手机号码|13524983970
flag|字符串|请求类型标识，固定为weixinunicom|weixinunicom
sign|字符串|签名信息(见鉴权方式)|B36DB08CB7E7BF0C6A205221444F374F
#### 接口返回信息
字段名称|字段类型|字段描述|示例数据
---|:--:|---:|---:
ret|字符串|返回码； 0表示成功，非0表示出错|0
msg|字符串|错误信息|鉴权失败


### 4 取消改号
##### 请求url：http://172.35.21.28:12542
##### 请求方式post
##### 参数以json格式传输
##### 请求字段如下:
字段名称|字段类型|字段描述|示例数据
---|:--:|---:|---:
category|字符串|方法名称标识，此接口为cancelChangeTel|cancelChangeTel
ownernumber|字符串|手机号码|17602100074
flag|字符串|请求类型标识，固定为weixinunicom|weixinunicom
sign|字符串|签名信息(见鉴权方式)|B36DB08CB7E7BF0C6A205221444F374F
#### 接口返回信息
字段名称|字段类型|字段描述|示例数据
---|:--:|---:|---:
ret|字符串|返回码； 0表示成功，非0表示出错|0
msg|字符串|错误信息|鉴权失败

### 5 设置情景模式
##### 请求url：http://172.35.21.28:12542
##### 请求方式post
##### 参数以json格式传输
##### 请求字段如下:
字段名称|字段类型|字段描述|示例数据
---|:--:|---:|---:
category|字符串|方法名称标识，此接口为setMode|setMode
ownernumber|字符串|手机号码|17602100074
modetype|字符串|情景模式,1正常模式，2会议模式，3关机模式，4休息模式|1
flag|字符串|请求类型标识，固定为weixinunicom|weixinunicom
sign|字符串|签名信息(见鉴权方式)|B36DB08CB7E7BF0C6A205221444F374F
#### 接口返回信息
字段名称|字段类型|字段描述|示例数据
---|:--:|---:|---:
ret|字符串|返回码； 0表示成功，非0表示出错|0
msg|字符串|错误信息|鉴权失败

### 6 套餐订购
##### 请求url：http://172.35.21.28:12542
##### 请求方式post
##### 参数以json格式传输
##### 请求字段如下:
字段名称|字段类型|字段描述|示例数据
---|:--:|---:|---:
category|字符串|方法名称标识，此接口为order|order
ownernumber|字符串|手机号码|17602100074
type|字符串|套餐类型|4
flag|字符串|请求类型标识，固定为weixinunicom|weixinunicom
sign|字符串|签名信息(见鉴权方式)|B36DB08CB7E7BF0C6A205221444F374F
#### 接口返回信息
字段名称|字段类型|字段描述|示例数据
---|:--:|---:|---:
ret|字符串|返回码； 0表示成功，1输入有误请重试，2系统错误，3已经订购，4订购处理中,请稍等，5当前退订处理中,不能订购|0
msg|字符串|错误信息|订购处理中,请稍等


### 7 漏话记录查询
##### 请求url：http://172.35.21.28:12542
##### 请求方式post
##### 参数以json格式传输
##### 请求字段如下:
字段名称|字段类型|字段描述|示例数据
---|:--:|---:|---:
category|字符串|方法名称标识，此接口为querymisscall|querymisscall
ownernumber|字符串|被叫号码|17602100074
caller|字符串|主叫号码|17602100074
pageno|字符串|查询分页，页数|1
pagenum|字符串|每页条数|10
flag|字符串|请求类型标识，固定为weixinunicom|weixinunicom
sign|字符串|签名信息(见鉴权方式)|B36DB08CB7E7BF0C6A205221444F374F
#### 接口返回信息
字段名称|字段类型|字段描述|示例数据
---|:--:|---:|---:
ret|字符串|返回码； 0表示成功，|0
msg|字符串|错误信息|订购处理中,请稍等
phonelist|字符串|漏话列表|
total|字符串|总条数|100
